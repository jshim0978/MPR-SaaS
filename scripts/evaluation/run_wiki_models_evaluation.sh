#!/bin/bash

# Set environment variables
export WANDB_DISABLED=true
export HF_HOME="/home/hf_cache"
export TRANSFORMERS_CACHE="/home/hf_cache"
export LD_LIBRARY_PATH="/usr/local/lib/python3.12/site-packages/nvidia/nccl/lib:/usr/local/lib/python3.12/site-packages/nvidia/cudnn/lib:/usr/local/lib/python3.12/site-packages/nvidia/cuda_cupti/lib:/usr/local/cuda-12.9/extras/CUPTI/lib64:$LD_LIBRARY_PATH"
export CUDA_VISIBLE_DEVICES=0

cat << 'EOF'

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         ðŸ§  WIKIPEDIA-FOCUSED MODELS EVALUATION                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Testing models trained WITHOUT KILT WOW:
   â€¢ 3B Wikipedia-only
   â€¢ 3B Wikidata-only
   â€¢ 3B Wiki+Wikidata (no KILT)
   â€¢ 8B Wikipedia-only
   â€¢ 8B Wikidata-only
   â€¢ 8B Wiki+Wikidata (no KILT)

ðŸ“ Test Setup:
   â€¢ 20 factual questions (HHEM benchmark)
   â€¢ Assessing: detail, accuracy, informativeness
   â€¢ Excluding: conversational/dialogue models

â±ï¸  Estimated time: ~30-40 minutes
ðŸŽ¯ Goal: Find models that provide detailed, factual, non-conversational responses

EOF

echo ""
echo "ðŸš€ Starting evaluation..."
echo ""

python3 /home/scripts/evaluation/evaluate_wiki_models_only.py

if [ $? -eq 0 ]; then
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "âœ… EVALUATION COMPLETE"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "ðŸ“ Results saved to:"
    echo "   â€¢ /home/evaluation_wiki_models_only.json"
    echo ""
    echo "ðŸ“Š Running analysis..."
    echo ""
    python3 /home/scripts/evaluation/analyze_wiki_models.py
else
    echo ""
    echo "âŒ Evaluation failed. Check the logs above for errors."
    echo ""
fi

